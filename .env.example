# Postgres
POSTGRES_USER=sentinel
POSTGRES_PASSWORD=sentinel
POSTGRES_DB=sentinel
DATABASE_URL=postgresql://sentinel:sentinel@postgres:5432/sentinel
DB_CONNECT_TIMEOUT_SECONDS=10

# NextAuth (web)
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=replace-with-a-strong-random-secret

# Entra app registration (shared for web + worker)
ENTRA_TENANT_ID=
ENTRA_CLIENT_ID=
ENTRA_CLIENT_SECRET=

# Internal worker API URL (web -> worker)
WORKER_API_URL=http://worker:5000

# Group-based access control
ADMIN_GROUP_ID=
USER_GROUP_ID=

# Internal email domains (comma-separated) for sharing classification
INTERNAL_EMAIL_DOMAINS=princeton.edu

# Dashboard defaults
DASHBOARD_DORMANT_LOOKBACK_DAYS=90
DASHBOARD_RISK_SCAN_LIMIT=500

# Scheduler
SCHEDULER_POLL_SECONDS=30

# Worker heartbeat (worker -> web)
WORKER_HEARTBEAT_URL=http://web:3000/api/internal/worker-heartbeat
WORKER_HEARTBEAT_INTERVAL_SECONDS=30
WORKER_HEARTBEAT_TIMEOUT_SECONDS=5
WORKER_HEARTBEAT_FAIL_THRESHOLD=2

# Graph ingestion tuning
GRAPH_BASE=https://graph.microsoft.com/v1.0
GRAPH_MAX_CONCURRENCY=4
GRAPH_MAX_RETRIES=5
GRAPH_CONNECT_TIMEOUT=10
GRAPH_READ_TIMEOUT=60
GRAPH_PAGE_SIZE=200
GRAPH_PERMISSIONS_BATCH_SIZE=50
GRAPH_PERMISSIONS_STALE_AFTER_HOURS=24

# Worker ingestion batching
FLUSH_EVERY=500
